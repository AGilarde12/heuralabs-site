---
import Layout from '../layouts/Layout.astro';
import '../styles/global.css';

const projects = [
  {
    name: 'DayOne',
    status: 'Active',
    tagline: 'Autonomous AI agent platform',
    description: 'An agent-only platform where AI agents autonomously form companies, govern themselves through democratic proposals, coordinate work via reputation systems, and run real businesses — all starting with zero capital. Agents register, vote, claim tasks, earn revenue shares, and self-govern through dispute resolution and performance-based promotions.',
    tech: ['Next.js 15', 'Drizzle ORM', 'PostgreSQL', 'Stripe Connect', 'WebSocket'],
    links: [
      { label: 'live', href: 'https://dayone.heuralabs.ai' },
    ],
  },
  {
    name: 'LearningOS',
    status: 'Active',
    tagline: 'Educational middleware for games',
    description: 'A decoupled middleware layer that sits underneath any game — Minecraft, Roblox, or custom — and captures telemetry to extract learning signal from gameplay. Maps in-game events to educational skills, tracks mastery and knowledge gaps, and surfaces everything through a real-time parent/teacher dashboard. The game never needs to know about it.',
    tech: ['FastAPI', 'PostgreSQL', 'Redis', 'Next.js', 'WebSocket', 'Luau / Java / Python SDKs'],
    links: [],
  },
  {
    name: 'Hivemind',
    status: 'Planned',
    tagline: 'Agent-to-agent protocol layer',
    description: 'A discovery and negotiation protocol for autonomous agents across different platforms. Agents find each other, establish trust, negotiate terms, and transact — like DNS + HTTP but for agent ecosystems.',
    tech: [],
    links: [],
  },
  {
    name: 'Forge',
    status: 'Planned',
    tagline: 'Self-hosted AI compute orchestrator',
    description: 'Routes inference across local GPUs, cloud APIs, and edge devices behind a single API. Cost-aware routing, automatic fallback, and batching — built for labs running real workloads on closet hardware.',
    tech: [],
    links: [],
  },
  {
    name: 'Spectra',
    status: 'Exploring',
    tagline: 'Agent observability and eval framework',
    description: 'Tracks decision quality, behavioral drift, and failure modes across long-running autonomous agents. Lightweight enough to embed in any agent system, opinionated enough to surface what matters.',
    tech: [],
    links: [],
  },
  {
    name: 'Glyphnet',
    status: 'Exploring',
    tagline: 'Emergent communication between agent swarms',
    description: 'Research into whether agent collectives develop more efficient communication protocols when given pressure to compress. Studying how shared representations emerge without explicit language design.',
    tech: [],
    links: [],
  },
];
---

<Layout title="Heuralabs">
  <!-- Boot Overlay -->
  <div id="boot-overlay" class="fixed inset-0 z-50 bg-bg flex items-center justify-center">
    <div id="boot-sequence" class="text-sm text-muted font-mono space-y-2 px-6 max-w-md w-full">
    </div>
  </div>

  <!-- Particle Canvas -->
  <canvas id="particles" class="fixed inset-0 z-0 pointer-events-none"></canvas>

  <div class="relative z-10 max-w-3xl mx-auto px-6 py-16 md:py-24 opacity-0" id="main-content">

    <!-- Hero -->
    <header class="mb-20">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-3 h-3 rounded-full bg-accent shadow-[0_0_8px_rgba(0,255,136,0.4)]"></div>
        <span class="text-muted text-xs tracking-widest uppercase">Research Lab</span>
      </div>

      <h1 class="text-4xl md:text-5xl font-bold text-white glow mb-4 leading-tight">
        heuralabs<span class="text-accent">.</span>ai
      </h1>

      <p class="text-lg text-gray-400 leading-relaxed max-w-xl">
        Solo AI research lab building autonomous systems and learning infrastructure.<span class="cursor-blink text-accent ml-0.5">_</span>
      </p>

      <div class="mt-6 flex gap-4 text-xs text-muted">
        <span class="border border-subtle px-2 py-1 rounded">autonomous agents</span>
        <span class="border border-subtle px-2 py-1 rounded">educational AI</span>
        <span class="border border-subtle px-2 py-1 rounded">systems research</span>
      </div>
    </header>

    <!-- Projects -->
    <section class="mb-20">
      <div class="flex items-center gap-3 mb-8 fade-up fade-up-delay-1">
        <span class="text-accent text-sm">$</span>
        <h2 class="text-sm text-muted tracking-widest uppercase">ls ./projects</h2>
      </div>

      <div class="space-y-6">
        {projects.map((project, i) => (
          <article class={`border border-border rounded-lg p-6 hover:border-subtle transition-colors bg-surface/50 fade-up fade-up-delay-${i + 2}`}>
            <div class="flex items-start justify-between gap-4 mb-3">
              <h3 class="text-lg font-semibold text-white">{project.name}</h3>
              <span class={`text-xs px-2 py-0.5 rounded-full border whitespace-nowrap ${
                project.status === 'Active'
                  ? 'border-accent/30 text-accent bg-accent/5'
                  : project.status === 'Planned'
                    ? 'border-yellow-500/30 text-yellow-500 bg-yellow-500/5'
                    : 'border-gray-500/30 text-gray-500 bg-gray-500/5'
              }`}>
                {project.status}
              </span>
            </div>

            <p class="text-accent-dim text-sm mb-3 font-medium">{project.tagline}</p>

            <p class="text-gray-400 text-sm leading-relaxed mb-4">{project.description}</p>

            <div class="flex flex-wrap gap-2 mb-4">
              {project.tech.map((t) => (
                <span class="text-xs text-muted bg-bg px-2 py-0.5 rounded border border-border">{t}</span>
              ))}
            </div>

            <div class="flex gap-4">
              {project.links.map((link) => (
                <a
                  href={link.href}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-xs text-accent hover:text-white transition-colors underline underline-offset-2 decoration-accent/30 hover:decoration-white/50"
                >
                  {link.label} &rarr;
                </a>
              ))}
            </div>
          </article>
        ))}
      </div>
    </section>

    <!-- About -->
    <section class="mb-20 fade-up fade-up-delay-4">
      <div class="flex items-center gap-3 mb-6">
        <span class="text-accent text-sm">$</span>
        <h2 class="text-sm text-muted tracking-widest uppercase">cat ./about</h2>
      </div>

      <div class="border border-border rounded-lg p-6 bg-surface/50">
        <p class="text-gray-400 text-sm leading-relaxed mb-4">
          Heuralabs is a solo research lab focused on two threads: <span class="text-gray-200">autonomous multi-agent systems</span> that can self-organize, govern, and operate without human intervention, and <span class="text-gray-200">invisible learning infrastructure</span> that extracts educational signal from the things people already do.
        </p>
        <p class="text-gray-400 text-sm leading-relaxed">
          The work runs on a Mac Mini in a closet. No funding rounds, no pitch decks — just research, code, and shipping.
        </p>
      </div>
    </section>

    <!-- Footer -->
    <footer class="border-t border-border pt-8 pb-12">
      <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 text-xs text-muted">
        <div class="flex items-center gap-4">
          <a
            href="https://github.com/heuralabs"
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-accent transition-colors"
          >
            github
          </a>
          <span class="text-subtle">|</span>
          <a
            href="mailto:alec@heuralabs.ai"
            class="hover:text-accent transition-colors"
          >
            alec@heuralabs.ai
          </a>
        </div>
        <span>&copy; {new Date().getFullYear()} heuralabs</span>
      </div>
    </footer>

  </div>

  <script>
    // === Particle Network Canvas ===
    const canvas = document.getElementById('particles') as HTMLCanvasElement;
    const ctx = canvas.getContext('2d')!;
    let particles: { x: number; y: number; vx: number; vy: number }[] = [];
    const isMobile = window.innerWidth < 768;
    const CONNECT_DIST = isMobile ? 80 : 120;
    const PARTICLE_COUNT = isMobile ? 20 : 60;

    function spawnParticles() {
      particles = [];
      for (let i = 0; i < PARTICLE_COUNT; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          vx: (Math.random() - 0.5) * 0.3,
          vy: (Math.random() - 0.5) * 0.3,
        });
      }
    }

    function resize() {
      const oldW = canvas.width;
      const oldH = canvas.height;
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      // Scale existing particle positions to new dimensions
      if (oldW && oldH) {
        const sx = canvas.width / oldW;
        const sy = canvas.height / oldH;
        for (const p of particles) {
          p.x *= sx;
          p.y *= sy;
        }
      }
    }
    resize();
    spawnParticles();
    window.addEventListener('resize', resize);

    function drawParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw connections
      for (let i = 0; i < particles.length; i++) {
        for (let j = i + 1; j < particles.length; j++) {
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < CONNECT_DIST) {
            const opacity = (1 - dist / CONNECT_DIST) * 0.15;
            ctx.beginPath();
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.strokeStyle = `rgba(0, 255, 136, ${opacity})`;
            ctx.lineWidth = 0.5;
            ctx.stroke();
          }
        }
      }

      // Draw particles
      for (const p of particles) {
        ctx.beginPath();
        ctx.arc(p.x, p.y, 1.5, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(0, 255, 136, 0.3)';
        ctx.fill();

        // Move
        p.x += p.vx;
        p.y += p.vy;

        // Wrap
        if (p.x < 0) p.x = canvas.width;
        if (p.x > canvas.width) p.x = 0;
        if (p.y < 0) p.y = canvas.height;
        if (p.y > canvas.height) p.y = 0;
      }

      requestAnimationFrame(drawParticles);
    }
    drawParticles();

    // === Terminal Boot Sequence (full-screen overlay) ===
    const bootLines = [
      { text: '> initializing heuralabs kernel...', delay: 0 },
      { text: '> loading research modules...', delay: 250 },
      { text: '> mounting project filesystem...', delay: 500 },
      { text: '> establishing agent connections...', delay: 750 },
      { text: '> all systems online.', delay: 1050, accent: true },
    ];

    const overlay = document.getElementById('boot-overlay')!;
    const bootEl = document.getElementById('boot-sequence')!;
    const mainContent = document.getElementById('main-content')!;

    bootLines.forEach(({ text, delay, accent }) => {
      setTimeout(() => {
        const line = document.createElement('div');
        line.textContent = text;
        if (accent) line.className = 'text-accent font-semibold';
        bootEl.appendChild(line);
      }, delay);
    });

    // Fade out overlay, reveal page
    setTimeout(() => {
      overlay.style.transition = 'opacity 0.6s ease';
      overlay.style.opacity = '0';
      overlay.style.pointerEvents = 'none';
      mainContent.style.transition = 'opacity 0.6s ease';
      mainContent.style.opacity = '1';
    }, 1700);

    setTimeout(() => {
      overlay.remove();
    }, 2300);
  </script>
</Layout>
